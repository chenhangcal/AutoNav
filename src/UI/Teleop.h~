#ifndef _TELEOP_H_
#define _TELEOP_H_

#include <QtGui>
#include <QWidget>
#include <ros/ros.h>
#include <std_msgs/Empty.h>
#include <std_srvs/Empty.h>
#include <geometry_msgs/Twist.h>
#include <algorithm>

class Keypress : public QWidget
{
  //Q_OBJECT
 private:
  ros::NodeHandle n;

  ros::Publisher vel_pub;
  ros::Publisher takeoff_pub;
  ros::Publisher land_pub;
  ros::Publisher toggleState_pub;

  ros::Subscriber vel_sub;

  ros::ServiceClient flattrim_srv;

  std_srvs::Empty flattrim_srv_empty;

  double speed,turn;

  QLabel* myLabel;
  QVBoxLayout *mainLayout;

 public:  
  Keypress(QWidget *parent = 0);
  ~Keypress();

  void keyPressEvent(QKeyEvent *key); 
  void keyReleaseEvent(QKeyEvent *key);

  void run();
  int mapKey(int k);

  bool isPressed[8];
  unsigned int velCount;

  geometry_msgs::Twist calcKBControl();

  void publishCommand(geometry_msgs::Twist cmd);

  void velCB(const geometry_msgs::TwistConstPtr cmd);

  void sendTakeOff();
  void sendLand();
  void sendToggleState();
  void sendFlatTrim();
};  
 
#endif //Teleop.h
